# Документация к коду для работы с файлами и их обработкой

Этот файл содержит функции для обработки файлов в папке. Код выполняет операции чтения файлов, переименования файлов с расширениями и их парсинга. Также используется логирование ошибок и успехов.

## Импортируемые модули

- **`fs`**: Модуль для работы с файловой системой, используется для чтения, записи и переименования файлов.
- **`path`**: Модуль для работы с путями файлов и каталогов.
- **`parseFile`**: Функция для парсинга содержимого файлов (описана в другом файле).
- **`logger`**: Логгер для записи логов (см. [логгер](../log/log.js)).
- **`makeListArray`**: Функция для работы с архивами (описана в другом файле).

## Описание функций

### Функция `ParseFolder`

```javascript
export const ParseFolder = (folderPath) => {
  const files = fs.readdirSync(folderPath);
  files.forEach(file => {
    readFile(`${folderPath}/${file}`);
  });
};
```

- **Описание**: Эта функция читает все файлы в указанной директории `folderPath` и вызывает функцию `readFile` для каждого файла.
- **Параметры**:
  - `folderPath`: Путь к папке, содержащей файлы, которые нужно обработать.
- **Возвращаемое значение**: Функция ничего не возвращает, но вызывает обработку каждого файла в папке с помощью функции `readFile`.

### Функция `readFile`

```javascript
export function readFile(filePath) {
  const extname = _extname(filePath).toLowerCase();
  if (!extname) {
    _readFile(filePath, 'utf8', (err, data) => {
      if (err) {
        logger.error({
          filePath: filePath,
          description: `Ошибка при извлечении данных с файла, ${err}`
        });
        console.error('Ошибка при чтении файла:', err);
      } else {
        parseFile(data, filePath);
      }
    });
  } else {
    const newFilePath = path.join(path.dirname(filePath), path.basename(filePath, path.extname(filePath)));

    // Переименование файла
    fs.rename(filePath, newFilePath, (err) => {
      if (err) {
        console.error('Ошибка при переименовании:', err);
      } else {
        _readFile(newFilePath, 'utf8', (err, data) => {
          if (err) {
            logger.error({
              filePath: newFilePath,
              description: `Ошибка при извлечении данных с файла, ${err}`
            });
            console.error('Ошибка при чтении файла:', err);
          } else {
            parseFile(data, newFilePath);
          }
        });
      }
    });
  }
}
```

- **Описание**: Эта функция читает файл по указанному пути `filePath`. Если у файла нет расширения, файл читается напрямую. Если у файла есть расширение, он переименовывается (удаляется расширение), а затем считывается.
- **Параметры**:
  - `filePath`: Путь к файлу, который нужно прочитать.
- **Логика**:
  - Если у файла нет расширения, он читается как текстовый файл с помощью `_readFile`, и затем передается на парсинг с помощью `parseFile`.
  - Если у файла есть расширение, файл переименовывается (расширение удаляется), затем его содержимое читается и передается в `parseFile`.
- **Возвращаемое значение**: Функция ничего не возвращает, но вызывает парсинг данных с помощью `parseFile`.

### Функция `workingFile`

```javascript
export const workingFile = () => {
  makeListArray(pathFolderinArray, outputPathFolderinArray);
};
```

- **Описание**: Эта функция вызывает `makeListArray`, которая предназначена для обработки файлов (например, распаковки архивов) в указанной папке.
- **Параметры**: Функция не принимает параметры, но использует глобальные переменные `pathFolderinArray` и `outputPathFolderinArray`.
- **Возвращаемое значение**: Функция ничего не возвращает, но запускает обработку файлов с помощью `makeListArray`.

## Пример использования

```javascript
import { ParseFolder } from './path/to/your/file';

// Путь к папке для обработки
const folderPath = './path/to/folder';

// Запуск обработки файлов в папке
ParseFolder(folderPath);
```

## Примечания

- **Переименование файлов**: Функция `readFile` пытается переименовать файлы, удаляя их расширение. Это может быть полезно, если нужно работать с файлами без расширений.
- **Чтение файлов без расширений**: Файлы без расширений читаются непосредственно, не происходит их переименования.
- **Ошибка при чтении или обработке файла**: В случае ошибок при чтении или обработке файла логируется ошибка с путем файла и описанием проблемы.
- **Взаимодействие с другими модулями**: Функции `parseFile` и `makeListArray` вызываются для дальнейшей обработки данных после их чтения.

## Зависимости

- **`fs`**: Встроенный модуль Node.js для работы с файловой системой.
- **`path`**: Встроенный модуль Node.js для работы с путями файлов и каталогов.
- **`logger`**: Модуль для логирования ошибок и информации.
- **`parseFile`**: Функция для парсинга файлов (должна быть определена в другом файле).
- **`makeListArray`**: Функция для работы с файлами или архивами (должна быть определена в другом файле).
